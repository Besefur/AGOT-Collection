##############################
# CHANCELLOR
# JOB: Perform Statecraft
##############################

namespace = MNM

character_event = {
	id = MNM.78000
	title = MNM.78000.t
	desc = MNM.78000.d
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_diplomacy

	min_age = 16
	only_capable = yes
	prisoner = no
	has_dlc = "Mystics"
	has_job_title = yes

	trigger = {
		OR = {
			has_job_action = action_statecraft
			has_job_action = action_oversee_province
		}
		NOT = { is_inaccessible_trigger = yes }
		liege = {
			NOT = {
				has_character_modifier = popular_ruler
			}
		}
	}

	mean_time_to_happen = {
		months = 100

		modifier = {
			factor = 2
			has_job_title = job_castellan
		}
		modifier = {
			factor = 1.25
			diplomacy < 2
		}
		modifier = {
			factor = 1.25
			diplomacy < 3
		}
		modifier = {
			factor = 1.25
			diplomacy < 4
		}
		modifier = {
			factor = 1.25
			diplomacy < 5
		}
		modifier = {
			factor = 0.95
			diplomacy = 10
		}
		modifier = {
			factor = 0.95
			diplomacy = 11
		}
		modifier = {
			factor = 0.9
			diplomacy = 12
		}
		modifier = {
			factor = 0.9
			diplomacy = 13
		}
		modifier = {
			factor = 0.9
			diplomacy = 14
		}
		modifier = {
			factor = 0.8
			diplomacy = 16
		}
		modifier = {
			factor = 0.8
			diplomacy = 18
		}
		modifier = {
			factor = 0.8
			diplomacy = 20
		}
		modifier = {
			factor = 0.8
			diplomacy = 22
		}
		modifier = {
			factor = 0.8
			diplomacy = 24
		}
		modifier = {
			factor = 0.8
			diplomacy = 26
		}
		modifier = {
			factor = 0.8
			diplomacy = 28
		}
		modifier = {
			factor = 2
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	option = {
		name = OK
		liege = {
			character_event = { id = MNM.78001 }
		}
	}
}

character_event = {
	id = MNM.78001

	is_triggered_only = yes

	hide_window = yes

	immediate = { #pick best target, if no good one add a small general opinion bonus for a time. don't fire these events while that modifier is active
		save_event_target_as = chancellor_employer
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = -25 } }
				OR = {
					higher_tier_than = COUNT
					relative_power_to_liege = 0.1
					ROOT = { tier = COUNT }
				}
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = 0 } }
				OR = {
					higher_tier_than = COUNT
					relative_power_to_liege = 0.1
					ROOT = { tier = COUNT }
				}
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = 25 } }
				OR = {
					higher_tier_than = COUNT
					relative_power_to_liege = 0.1
					ROOT = { tier = COUNT }
				}
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		if = { #reasons to target fellow vassals
			limit = {
				independent = no
				OR = {
					AND = { #leading a hostile faction/plot
						OR = {
							leads_faction = yes
							plot_target_char = { is_liege_of = ROOT }
						}
						NOT = { in_faction = faction_liege_loyalist }
						NOT = {
							AND = {
								liege = { tier = EMPEROR }
								in_faction = faction_crown_loyalist
							}
						}
					}
					has_minor_title = title_regent	#is regent
					AND = { #realm is elective, get votes
						higher_tier_than = COUNT
						crownlaw_title = {
							has_elective_law_trigger = yes
							holder_scope = { is_liege_of = ROOT }
						}
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -75 }
						NOT = { opinion = { who = ROOT value = 25 } }
						OR = {
							higher_tier_than = COUNT
							relative_power_to_liege = 0.1
							ROOT = { tier = COUNT }
						}
						prisoner = no
						is_incapable = no
						NOT = { character = FROM }
						NOT = { is_inaccessible_trigger = yes }
						NOT = { in_faction = faction_liege_loyalist }
						NOT = {
							AND = {
								liege = { tier = EMPEROR }
								in_faction = faction_crown_loyalist
							}
						}
						ai = yes
					}
					save_event_target_as = statecraft_target
					break = yes
				}
				random_vassal = {
					limit = {
						opinion = { who = ROOT value = -75 }
						NOT = { opinion = { who = ROOT value = 25 } }
						prisoner = no
						is_incapable = no
						NOT = { character = FROM }
						NOT = { is_inaccessible_trigger = yes }
						NOT = { in_faction = faction_liege_loyalist }
						NOT = {
							AND = {
								liege = { tier = EMPEROR }
								in_faction = faction_crown_loyalist
							}
						}
						ai = yes
					}
					save_event_target_as = statecraft_target
					break = yes
				}
			}
		}
		if = {
			limit = {
				independent = no
				liege = {
					opinion = { who = ROOT value = -75 }
					NOT = { opinion = { who = ROOT value = 25 } }
					prisoner = no
					is_incapable = no
					NOT = { is_inaccessible_trigger = yes }
					ai = yes
					# NAND = { #Only target player if ROOT likes them, and is not low tier
						# ai = no
						# OR = {
							# NOT = { reverse_opinion = { who = ROOT value = 10 } }
							# AND = {
								# tier = EMPEROR
								# ROOT = { lower_tier_than = DUKE }
							# }
						# }
					# }
				}
			}
			liege = {
				save_event_target_as = statecraft_target
			}
			break = yes
		}
		random_realm_province = {
			limit = {
				any_neighbor_province = {
					owner = {
						NOT = { same_realm = ROOT }
						top_liege = {
							opinion = { who = ROOT value = -75 }
							NOT = { opinion = { who = ROOT value = 25 } }
							prisoner = no
							is_incapable = no
							NOT = { character = FROM }
							NOT = { is_inaccessible_trigger = yes }
							ai = yes
							# NAND = { #Only target player if ROOT likes them, and is not low tier
								# ai = no
								# OR = {
									# NOT = { reverse_opinion = { who = ROOT value = 10 } }
									# AND = {
										# tier = EMPEROR
										# ROOT = { lower_tier_than = DUKE }
									# }
								# }
							# }
						}
					}
				}
			}
			random_neighbor_province = {
				limit = {
					owner = {
						NOT = { same_realm = ROOT }
						top_liege = {
							opinion = { who = ROOT value = -75 }
							NOT = { opinion = { who = ROOT value = 25 } }
							prisoner = no
							is_incapable = no
							NOT = { character = FROM }
							NOT = { is_inaccessible_trigger = yes }
							ai = yes
							# NAND = { #Only target player if ROOT likes them, and is not low tier
								# ai = no
								# OR = {
									# NOT = { reverse_opinion = { who = ROOT value = 10 } }
									# AND = {
										# tier = EMPEROR
										# ROOT = { lower_tier_than = DUKE }
									# }
								# }
							# }
						}
					}
				}
				owner = {
					top_liege = {
						save_event_target_as = statecraft_target
						break = yes
					}
				}
			}
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = 50 } }
				OR = {
					higher_tier_than = COUNT
					relative_power_to_liege = 0.1
					ROOT = { tier = COUNT }
				}
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = -25 } }
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = 0 } }
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = 25 } }
				prisoner = no
				is_incapable = no
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		if = {
			limit = {
				independent = no
				liege = {
					opinion = { who = ROOT value = -75 }
					NOT = { opinion = { who = ROOT value = 50 } }
					prisoner = no
					is_incapable = no
					NOT = { character = FROM }
					NOT = { is_inaccessible_trigger = yes }
					ai = yes
					# NAND = { #Only target player if ROOT likes them, and is not low tier
						# ai = no
						# OR = {
							# NOT = { reverse_opinion = { who = ROOT value = 10 } }
							# AND = {
								# tier = EMPEROR
								# ROOT = { lower_tier_than = DUKE }
							# }
						# }
					# }
				}
			}
			liege = {
				save_event_target_as = statecraft_target
			}
			break = yes
		}
		random_vassal = {
			limit = {
				opinion = { who = ROOT value = -75 }
				NOT = { opinion = { who = ROOT value = 50 } }
				prisoner = no
				is_incapable = no
				NOT = { character = FROM }
				NOT = { is_inaccessible_trigger = yes }
				ai = yes
			}
			save_event_target_as = statecraft_target
			break = yes
		}
		if = {
			limit = {
				NOT = { has_character_modifier = popular_ruler }
			}
			FROM = {
				letter_event = { id = MNM.78006 }
			}
		}
	}

	after = {
		event_target:statecraft_target = {
			character_event = { id = MNM.78004 }
		}
	}
}

character_event = {
	id = MNM.78004

	is_triggered_only = yes

	hide_window = yes

	immediate = {
		FROMFROM = {
			change_variable = { which = "services_rendered" value = 1 }
			reverse_opinion = {
				modifier = opinion_service_rendered
				who = ROOT_FROM
				years = 3
			}
		}
		event_target:chancellor_employer = {
			letter_event = { id = MNM.78005 }
		}
	}
}

letter_event = {
	id = MNM.78005
	desc = 78001.d
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes
	show_from_from_from = yes

	#notification = yes

	option = {
		name = OK
		event_target:statecraft_target = {
			show_portrait = yes
			opinion = {
				modifier = opinion_improved_relations
				who = ROOT
				years = 4
			}
			hidden_tooltip = { character_event = { id = MNM.78002 } }
		}
	}
}

character_event = {
	id = MNM.78006

	is_triggered_only = yes

	hide_window = yes

	immediate = {
		change_variable = { which = "services_rendered" value = 1 }
		reverse_opinion = {
			modifier = opinion_service_rendered
			who = FROM
			years = 3
		}
		event_target:chancellor_employer = {
			letter_event = { id = MNM.78009 }
		}
	}
}

letter_event = {
	id = MNM.78009
	desc = 78001.d2
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	#notification = yes

	option = {
		name = OK
		add_character_modifier = {
			name = popular_ruler
			days = 730
		}
	}
}

#Inform the target
character_event = {
	id = MNM.78002
	desc = MNM.78002.d
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = MNM.78002.a
		show_portrait = FROMFROMFROMFROM
		if = {
			limit = { is_liege_of = FROM }
			if = {
				limit = {
					tier = EMPEROR
				}
				prestige = 40
			}
			else_if = {
				limit = {
					OR = {
						tier = KING
						spouse = { tier = EMPEROR }
						father_even_if_dead = { tier = EMPEROR }
						mother_even_if_dead = { tier = EMPEROR }
					}
				}
				prestige = 30
			}
			else_if = {
				limit = {
					OR = {
						tier = DUKE
						spouse = { tier = KING }
						father_even_if_dead = { tier = KING }
						mother_even_if_dead = { tier = KING }
					}
				}
				prestige = 20
			}
			else_if = {
				limit = {
					OR = {
						tier = COUNT
						spouse = { tier = DUKE }
						father_even_if_dead = { tier = DUKE }
						mother_even_if_dead = { tier = DUKE }
					}
				}
				prestige = 10
			}
			else = {
				prestige = 5
			}
		}

		if = { #If ROOT is player and opinion is high, add diplomatic immunity
			limit = {
				ai = no
				is_liege_of = FROM
				opinion = { who = FROM value = 25 }
			}
			FROM = {
				custom_tooltip = {
					text = TOOLTIPdiplomaticimmune
					#Five year diplomatic immunity
					diplomatic_immunity = yes
					character_event = { id = trial.500 days = 1825 }
				}
			}
		}
		else = {
			tooltip = {
				opinion = {
					modifier = opinion_improved_relations
					who = event_target:chancellor_employer
					years = 4
				}
			}
		}
	}
}

#Steward

character_event = {
	id = MNM.70005
	title = MNM.70005.t
	desc = MNM.70005.d
	picture = GFX_evt_carriage
	border = GFX_event_normal_frame_economy

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		OR = {
			has_job_action = action_administer_realm
			has_job_action = action_oversee_province
		}
		NOT = { is_inaccessible_trigger = yes }
	}

	mean_time_to_happen = {
		months = 220

		modifier = {
			factor = 2
			has_job_title = job_castellan
		}
		modifier = {
			factor = 1.25
			stewardship < 2
		}
		modifier = {
			factor = 1.25
			stewardship < 3
		}
		modifier = {
			factor = 1.25
			stewardship < 4
		}
		modifier = {
			factor = 1.25
			stewardship < 5
		}
		modifier = {
			factor = 0.75
			stewardship = 10
		}
		modifier = {
			factor = 0.75
			stewardship = 11
		}
		modifier = {
			factor = 0.75
			stewardship = 12
		}
		modifier = {
			factor = 0.75
			stewardship = 13
		}
		modifier = {
			factor = 0.75
			stewardship = 15
		}
		modifier = {
			factor = 0.75
			stewardship = 18
		}
		modifier = {
			factor = 2
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	option = {
		name = "EVTOPTA920"
		hidden_tooltip = { change_variable = { which = "services_rendered" value = 1 } }
		liege = {
			opinion = {
				modifier = opinion_service_rendered
				who = ROOT
				years = 3
			}
			character_event = { id = MNM.70006 }
		}
	}
}

character_event = {
	id = MNM.70006
	desc = MNM.70006.d
	picture = GFX_evt_carriage
	border = GFX_event_normal_frame_economy

	immediate = {
		if = {
			limit = {
				any_demesne_province = {
					can_add_admin_bonus_trigger = yes
				}
			}
			random_demesne_province = {
				limit = {
					can_add_admin_bonus_trigger = yes
				}
				save_event_target_as = admin_bonus_province
			}
			break = yes
		}
		capital_scope = {
			save_event_target_as = admin_bonus_province # For localisation
		}
		set_character_flag = no_possible_bonus
	}

	is_triggered_only = yes

	notification = yes

	option = {
		name = EXCELLENT
		if = {
			limit = {
				NOT = { has_character_flag = no_possible_bonus }
			}
			event_target:admin_bonus_province = {
				random_list = {
					100 = {
						modifier = {
							factor = 0
							has_province_modifier = harvest_festivals
						}
						add_province_modifier = {
							name = harvest_festivals
							years = 3
						}
						if = {
							limit = {
								has_dlc = "Reapers"
							}
							custom_tooltip = {
								text = increase_prosperity_custom_tooltip
								hidden_tooltip = {
									change_variable = { which = prosperity_value value = 6 }
								}
							}
						}
					}
					100 = {
						modifier = {
							factor = 0
							has_province_modifier = inspired_peasantry
						}
						add_province_modifier = {
							name = inspired_peasantry
							years = 3
						}
						if = {
							limit = {
								has_dlc = "Reapers"
							}
							custom_tooltip = {
								text = increase_prosperity_custom_tooltip
								hidden_tooltip = {
									change_variable = { which = prosperity_value value = 6 }
								}
							}
						}
					}
					100 = {
						modifier = {
							factor = 0
							has_province_modifier = new_roads
						}
						add_province_modifier = {
							name = new_roads
							years = 3
						}
						if = {
							limit = {
								has_dlc = "Reapers"
							}
							custom_tooltip = {
								text = increase_prosperity_custom_tooltip
								hidden_tooltip = {
									change_variable = { which = prosperity_value value = 6 }
								}
							}
						}
					}
				}
			}
		}

		if = {
			limit = {
				has_character_flag = no_possible_bonus
			}
			scaled_wealth = { value = 0.15 min = 10 max = 100 }
			clr_character_flag = no_possible_bonus
		}
	}

}

# The Steward allows a smugglers ring to appear
character_event = {
	id = MNM.78007
	title = MNM.78007.t
	desc = MNM.78007.d
	picture = GFX_evt_carriage
	border = GFX_event_normal_frame_economy

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		OR = {
			has_job_action = action_administer_realm
			has_job_action = action_oversee_province
		}
		NOT = { is_inaccessible_trigger = yes }
		liege = {
			any_demesne_province = {
				NOT = {
					has_province_modifier = smugglers_ring
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 220

		modifier = {
			factor = 2
			has_job_title = job_castellan
		}
		modifier = {
			factor = 0.75
			stewardship < 2
		}
		modifier = {
			factor = 0.75
			stewardship < 3
		}
		modifier = {
			factor = 0.75
			stewardship < 4
		}
		modifier = {
			factor = 0.75
			stewardship < 5
		}
		modifier = {
			factor = 1.25
			stewardship = 10
		}
		modifier = {
			factor = 1.25
			stewardship = 11
		}
		modifier = {
			factor = 1.25
			stewardship = 12
		}
		modifier = {
			factor = 1.25
			stewardship = 13
		}
		modifier = {
			factor = 1.25
			stewardship = 15
		}
		modifier = {
			factor = 1.25
			stewardship = 18
		}
		modifier = {
			factor = 0.5
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	option = {
		name = CURSES
		hidden_tooltip = {
			liege = {
				character_event = { id = MNM.78008 }
			}
		}
	}
}

character_event = {
	id = MNM.78008
	title = MNM.78007.t
	desc = MNM.78008.d
	picture = GFX_evt_carriage
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	min_age = 16
	only_capable = yes
	prisoner = no

	immediate = {
		random_demesne_province = {
			limit = {
				NOT = {
					has_province_modifier = smugglers_ring
				}
			}
			save_event_target_as = smuggler_province
		}
	}

	option = {
		name = CURSES
		event_target:smuggler_province = {
			add_province_modifier = {
				name = smugglers_ring
				years = 2
			}
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				custom_tooltip = {
					text = decrease_prosperity_custom_tooltip
					hidden_tooltip = {
						change_variable = { which = prosperity_value value = -6 }
					}
				}
			}
		}
	}
}

#Marshal
# Drill Commanders
character_event = {
	id = MNM.70010
	title =  MNM.70010.t
	desc =  MNM.70010.d
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		has_job_action = action_organize_army
		NOT = { is_inaccessible_trigger = yes }
		liege = {
			any_courtier_or_vassal = {
				NOT = { character = PREV }
				has_minor_title = title_commander
				NOT = {
					has_character_modifier = drill_cooldown_timer
				}
				NAND = {
					martial = 16
					OR = {
						trait = light_foot_leader
						trait = heavy_infantry_leader
						trait = cavalry_leader
						trait = inspiring_leader
						trait = trickster
						trait = organizer
						trait = defensive_leader
						trait = experimenter
						trait = flanker
						trait = aggressive_leader
						trait = siege_leader
						trait = flat_terrain_leader
						trait = rough_terrain_leader
						trait = mountain_terrain_leader
						trait = desert_terrain_leader
						trait = unyielding_leader
						trait = narrow_flank_leader
						trait = war_elephant_leader
						trait = jungle_terrain_leader
						#trait = winter_soldier
					}
				}
			}
		}
	}

	immediate = {
		liege = {
			random_courtier_or_vassal = {
				limit = {
					NOT = { character = PREV }
					has_minor_title = title_commander
					NOT = {
						has_character_modifier = drill_cooldown_timer
					}
					NAND = {
						martial = 16
						OR = {
							trait = light_foot_leader
							trait = heavy_infantry_leader
							trait = cavalry_leader
							trait = inspiring_leader
							trait = trickster
							trait = organizer
							trait = defensive_leader
							trait = experimenter
							trait = flanker
							trait = aggressive_leader
							trait = siege_leader
							trait = flat_terrain_leader
							trait = rough_terrain_leader
							trait = mountain_terrain_leader
							trait = desert_terrain_leader
							trait = unyielding_leader
							trait = narrow_flank_leader
							trait = war_elephant_leader
							trait = jungle_terrain_leader
							#trait = winter_soldier
						}
					}
				}
				save_event_target_as = commander_improved
			}
		}
	}

	mean_time_to_happen = {
		months = 240

		modifier = {
			factor = 1.25
			martial < 2
		}
		modifier = {
			factor = 1.25
			martial < 3
		}
		modifier = {
			factor = 1.25
			martial < 4
		}
		modifier = {
			factor = 1.25
			martial < 5
		}
		modifier = {
			factor = 0.9
			martial = 10
		}
		modifier = {
			factor = 0.9
			martial = 11
		}
		modifier = {
			factor = 0.8
			martial = 12
		}
		modifier = {
			factor = 0.8
			martial = 13
		}
		modifier = {
			factor = 0.8
			martial = 14
		}
		modifier = {
			factor = 0.8
			martial = 16
		}
		modifier = {
			factor = 0.8
			martial = 18
		}
		modifier = {
			factor = 0.8
			martial = 20
		}
		modifier = {
			factor = 0.8
			martial = 22
		}
		modifier = {
			factor = 0.8
			martial = 24
		}
		modifier = {
			factor = 0.8
			martial = 26
		}
		modifier = {
			factor = 0.8
			martial = 28
		}
		modifier = {
			factor = 2
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	option = {
		name =  EXCELLENT
		hidden_tooltip = { change_variable = { which = "services_rendered" value = 1 } }
		liege = {
			opinion = {
				modifier = opinion_service_rendered
				who = ROOT
				years = 3
			}
			character_event = { id = MNM.70011 }
		}
	}
}

character_event = {
	id = MNM.70011
	title =  MNM.70010.t
	desc =  MNM.70011.d
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				event_target:commander_improved = {
					NOR = {
						trait = light_foot_leader
						trait = heavy_infantry_leader
						trait = cavalry_leader
						trait = inspiring_leader
						trait = trickster
						trait = organizer
						trait = defensive_leader
						trait = experimenter
						trait = flanker
						trait = aggressive_leader
						trait = siege_leader
						trait = flat_terrain_leader
						trait = rough_terrain_leader
						trait = mountain_terrain_leader
						trait = desert_terrain_leader
						trait = unyielding_leader
						trait = narrow_flank_leader
						trait = war_elephant_leader
						trait = jungle_terrain_leader
						#trait = winter_soldier
					}
				}
			}
			event_target:commander_improved = {
				hidden_tooltip = {
					add_character_modifier = {
						name = drill_cooldown_timer
						hidden = yes
						years = 5
					}
				}
				random_list = {
					10 = {
						set_character_flag = light_foot_leader
					}
					10 = {
						set_character_flag = heavy_infantry_leader
					}
					10 = {
						set_character_flag = cavalry_leader
					}
					10 = {
						set_character_flag = trickster
					}
					10 = {
						set_character_flag = organizer
					}
					10 = {
						set_character_flag = defensive_leader
					}
					10 = {
						set_character_flag = experimenter
					}
					10 = {
						set_character_flag = flanker
					}
					10 = {
						set_character_flag = aggressive_leader
					}
					10 = {
						set_character_flag = siege_leader
					}
				}
			}
		}
	}

	option = {
		name =  EXCELLENT
		prestige = 5
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = light_foot_leader
				}
			}
			event_target:commander_improved = {
				add_trait = light_foot_leader
				clr_character_flag = light_foot_leader
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = heavy_infantry_leader
				}
			}
			event_target:commander_improved = {
				add_trait = heavy_infantry_leader
				clr_character_flag = heavy_infantry_leader
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = cavalry_leader
				}
			}
			event_target:commander_improved = {
				add_trait = cavalry_leader
				clr_character_flag = cavalry_leader
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = trickster
				}
			}
			event_target:commander_improved = {
				add_trait = trickster
				clr_character_flag = trickster
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = organizer
				}
			}
			event_target:commander_improved = {
				add_trait = organizer
				clr_character_flag = organizer
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = defensive_leader
				}
			}
			event_target:commander_improved = {
				add_trait = defensive_leader
				clr_character_flag = defensive_leader
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = experimenter
				}
			}
			event_target:commander_improved = {
				add_trait = experimenter
				clr_character_flag = experimenter
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = flanker
				}
			}
			event_target:commander_improved = {
				add_trait = flanker
				clr_character_flag = flanker
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = aggressive_leader
				}
			}
			event_target:commander_improved = {
				add_trait = aggressive_leader
				clr_character_flag = aggressive_leader
			}
		}
		if = {
			limit = {
				event_target:commander_improved = {
					has_character_flag = siege_leader
				}
			}
			event_target:commander_improved = {
				add_trait = siege_leader
				clr_character_flag = siege_leader
			}
		}
		event_target:commander_improved = {
			random_list = {
				70 = {
					modifier = {
						factor = 0
						OR = {
							trait = light_foot_leader
							trait = heavy_infantry_leader
							trait = cavalry_leader
							trait = inspiring_leader
							trait = trickster
							trait = organizer
							trait = defensive_leader
							trait = experimenter
							trait = flanker
							trait = aggressive_leader
							trait = siege_leader
							trait = flat_terrain_leader
							trait = rough_terrain_leader
							trait = mountain_terrain_leader
							trait = desert_terrain_leader
							trait = unyielding_leader
							trait = narrow_flank_leader
							trait = war_elephant_leader
							trait = jungle_terrain_leader
							#trait = winter_soldier
						}
					}
					change_martial = 1
				}
				20 = {
					change_martial = 2
				}
				10 = {
					change_martial = 3
				}
			}
		}
	}
}

#Find Commander
character_event = {
	id = MNM.70012
	title = MNM.70012.t
	desc = MNM.70012.d
	picture = GFX_evt_large_army
	border = GFX_event_normal_frame_war

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		has_job_action = action_organize_army
		NOT = { is_inaccessible_trigger = yes }
		liege = {
			OR = {
				AND = {
					ai = no
					any_courtier_or_vassal = {
						has_minor_title = title_commander
						martial < 12
					}
				}
				AND = {
					tier = COUNT
					NOT = { has_assigned_minor_title = { title = title_commander count = 2 } }
				}
				AND = {
					tier = DUKE
					NOT = { has_assigned_minor_title = { title = title_commander count = 4 } }
				}
				AND = {
					tier = KING
					is_nomadic = no
					NOT = { has_assigned_minor_title = { title = title_commander count = 6 } }
				}
				AND = {
					tier = EMPEROR
					is_nomadic = no
					NOT = { has_assigned_minor_title = { title = title_commander count = 8 } }
				}
				AND = {
					tier = KING
					is_nomadic = yes
					NOT = { has_assigned_minor_title = { title = title_commander count = 2 } }
				}
				AND = {
					tier = EMPEROR
					is_nomadic = yes
					NOT = { has_assigned_minor_title = { title = title_commander count = 4 } }
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 320

		modifier = {
			factor = 1.25
			martial < 2
		}
		modifier = {
			factor = 1.25
			martial < 3
		}
		modifier = {
			factor = 1.25
			martial < 4
		}
		modifier = {
			factor = 1.25
			martial < 5
		}
		modifier = {
			factor = 0.9
			martial = 10
		}
		modifier = {
			factor = 0.9
			martial = 11
		}
		modifier = {
			factor = 0.8
			martial = 12
		}
		modifier = {
			factor = 0.8
			martial = 13
		}
		modifier = {
			factor = 0.8
			martial = 14
		}
		modifier = {
			factor = 0.8
			martial = 16
		}
		modifier = {
			factor = 0.8
			martial = 18
		}
		modifier = {
			factor = 0.8
			martial = 20
		}
		modifier = {
			factor = 0.8
			martial = 22
		}
		modifier = {
			factor = 0.8
			martial = 24
		}
		modifier = {
			factor = 0.8
			martial = 26
		}
		modifier = {
			factor = 0.8
			martial = 28
		}
		modifier = {
			factor = 2
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	option = {
		name =  EXCELLENT
		hidden_tooltip = { change_variable = { which = "services_rendered" value = 1 } }
		liege = {
			opinion = {
				modifier = opinion_service_rendered
				who = ROOT
				years = 3
			}
			character_event = { id = MNM.70013 }
		}
	}
}

character_event = {
	id = MNM.70013
	desc =  MNM.70013.d
	picture = GFX_evt_large_army
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		random_demesne_province = {
			ROOT = {
				if = {
					limit = { PREV = { NOT = { female_warrior_culture_trigger = yes } } }
					create_random_soldier = {
						random_traits = yes
						dynasty = none
						female = no
						culture = PREV
						religion = PREV
					}
				}
				if = {
					limit = { PREV = { female_warrior_culture_trigger = yes } }
					create_random_soldier = {
						random_traits = yes
						dynasty = none
						female = yes
						culture = PREV
						religion = PREV
					}
				}
				new_character = {
					remove_trait = weak
					remove_trait = weak_1
					remove_trait = weak_2
					remove_trait = slow
					remove_trait = slow_1
					remove_trait = imbecile
					remove_trait = imbecile_1
					remove_trait = dull
					remove_trait = craven

					if = {
						limit = {
							trait = misguided_warrior
						}
						remove_trait = misguided_warrior
						add_trait = tough_soldier
					}
					remove_lifestyle_trait_effect = yes

					random_list = { # Flavor Randomization
						15 = {
							change_martial = 1
						}
						10 = {
							add_trait = robust
						}
						10 = {
							add_trait = duelist
						}
						10 = {
							add_trait = hunter
						}
						5 = {
							add_trait = strategist
						}
						5 = {
							change_martial = 3
						}
						5 = {
							if = {
								limit = {
									has_dlc = "Reapers"
								}
								add_trait = one_eyed
								change_martial = 1
							}
						}
						5 = {
							add_trait = shrewd
						}
					}
					random_list = {
						75 = { add_trait = trained_warrior }
						20 = { add_trait = skilled_warrior }
						5 = { add_trait = master_warrior }
					}
					if = {
						limit = { religion = the_seven }
						add_trait = knight
						if = {
							limit = {
								is_ruler = no
								NOT = { has_minor_title = title_prince }
								NOT = { has_minor_title = title_prince_AGOT }
								NOT = { has_minor_title = title_queen_mother }
								NOT = { has_minor_title = title_ruler_consort }
							}
							if = {
								limit = { is_female = no }
								set_special_character_title = title_ser
							}
							if = {
								limit = { is_female = yes }
								set_special_character_title = title_lady
							}
						}
					}
					while = {
						limit = { martial < 12 }
						change_martial = 1
					}
					save_event_target_as = found_commander
				}
			}
		}
	}


	option = {
		name = EXCELLENT
		event_target:found_commander = {
			opinion = {
				modifier = opinion_loyal_servant
				who = ROOT
				years = 5
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						tier = COUNT
						NOT = { has_assigned_minor_title = { title = title_commander count = 2 } }
					}
					AND = {
						tier = DUKE
						NOT = { has_assigned_minor_title = { title = title_commander count = 4 } }
					}
					AND = {
						tier = KING
						is_nomadic = no
						NOT = { has_assigned_minor_title = { title = title_commander count = 6 } }
					}
					AND = {
						tier = EMPEROR
						is_nomadic = no
						NOT = { has_assigned_minor_title = { title = title_commander count = 8 } }
					}
					AND = {
						tier = KING
						is_nomadic = yes
						NOT = { has_assigned_minor_title = { title = title_commander count = 2 } }
					}
					AND = {
						tier = EMPEROR
						is_nomadic = yes
						NOT = { has_assigned_minor_title = { title = title_commander count = 4 } }
					}
				}
			}
			event_target:found_commander = {
				give_minor_title = title_commander
			}
		}
	}

	# option = {
		# name = MNM.70013.o

		# trigger = {
			# any_courtier_or_vassal = {
				# NOT = { higher_tier_than = BARON }
				# liege = { character = ROOT }
				# has_minor_title = title_commander
				# martial < 12
			# }
			# OR = {
				# AND = {
					# tier = COUNT
					# NOT = { has_assigned_minor_title = { title = title_commander count = 2 } }
				# }
				# AND = {
					# tier = DUKE
					# NOT = { has_assigned_minor_title = { title = title_commander count = 4 } }
				# }
				# AND = {
					# tier = KING
					# is_nomadic = no
					# NOT = { has_assigned_minor_title = { title = title_commander count = 6 } }
				# }
				# AND = {
					# tier = EMPEROR
					# is_nomadic = no
					# NOT = { has_assigned_minor_title = { title = title_commander count = 8 } }
				# }
				# AND = {
					# tier = KING
					# is_nomadic = yes
					# NOT = { has_assigned_minor_title = { title = title_commander count = 2 } }
				# }
				# AND = {
					# tier = EMPEROR
					# is_nomadic = yes
					# NOT = { has_assigned_minor_title = { title = title_commander count = 4 } }
				# }
			# }
		# }
		# random_courtier_or_vassal = {
			# limit = {
				# NOT = { higher_tier_than = BARON }
				# liege = { character = ROOT }
				# has_minor_title = title_commander
				# martial < 12
			# }
			# remove_title = title_commander
			# opinion = {
				# modifier = insulted
				# who = ROOT
				# years = 2
			# }
		# }

		# event_target:found_commander = {
			# give_minor_title = title_commander
			# opinion = {
				# modifier = opinion_loyal_servant
				# who = ROOT
				# years = 5
			# }
		# }
	# }
}

# Commander/Marshal Fight
character_event = {
	id = MNM.70015
	title = MNM.70015.t
	desc = MNM.70015.d
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		has_job_action = action_organize_army
		NOT = { is_inaccessible_trigger = yes }
		can_be_maimed_trigger = yes
		liege = {
			any_courtier_or_vassal = {
				has_minor_title = title_commander
				can_be_maimed_trigger = yes
			}
		}
	}

	mean_time_to_happen = {
		months = 280

		modifier = {
			factor = 0.8
			martial < 2
		}
		modifier = {
			factor = 0.8
			martial < 3
		}
		modifier = {
			factor = 0.8
			martial < 4
		}
		modifier = {
			factor = 0.8
			martial < 5
		}
		modifier = {
			factor = 1.11
			martial = 10
		}
		modifier = {
			factor = 1.11
			martial = 11
		}
		modifier = {
			factor = 1.25
			martial = 12
		}
		modifier = {
			factor = 1.25
			martial = 13
		}
		modifier = {
			factor = 1.25
			martial = 14
		}
		modifier = {
			factor = 1.25
			martial = 16
		}
		modifier = {
			factor = 1.25
			martial = 18
		}
		modifier = {
			factor = 1.25
			martial = 20
		}
		modifier = {
			factor = 0.5
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	immediate = {
		save_event_target_as = marshal_character
		liege = {
			any_courtier_or_vassal = {
				limit = {
					has_minor_title = title_commander
					NOT = {
						character = ROOT
					}
				}
				save_event_target_as = commander_character
			}
		}
	}

	option = {
		name = CURSES
		event_target:commander_character = {
			add_rival = event_target:marshal_character
			random_list = {
				40 = {

				}
				45 = {
					add_trait_silently_wounded_effect = yes
					hidden_tooltip = { character_event = { id = 38280 } }
				}
				15 = {
					add_maimed_trait_effect = yes
				}
			}
		}
		event_target:marshal_character = {
			add_rival = event_target:commander_character
			random_list = {
				40 = {

				}
				45 = {
					add_trait_silently_wounded_effect = yes
					hidden_tooltip = { character_event = { id = 38280 } }
				}
				15 = {
					add_maimed_trait_effect = yes
				}
			}
		}
		liege = {
			character_event = { id = MNM.70016 }
		}
	}
}

character_event = {
	id = MNM.70016
	title = MNM.70015.t
	desc =  MNM.70016.d
	picture = GFX_evt_melee
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = {
		name = CURSES
		prestige = -10
		event_target:commander_character = {
			add_rival = event_target:marshal_character
		}
	}
}

#Spymaster
character_event = {
	id = MNM.70020
	title = MNM.70020.t
	desc = MNM.70020.d
	picture = GFX_evt_burning_house
	border = GFX_event_normal_frame_intrigue

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		has_job_action = action_sabotage_province
		NOT = { is_inaccessible_trigger = yes }
		location = {
			can_be_sabotaged_trigger = yes
		}
	}

	mean_time_to_happen = {
		months = 120

		modifier = {
			factor = 1.25
			intrigue < 2
		}
		modifier = {
			factor = 1.25
			intrigue < 3
		}
		modifier = {
			factor = 1.25
			intrigue < 4
		}
		modifier = {
			factor = 1.25
			intrigue < 5
		}
		modifier = {
			factor = 0.75
			intrigue = 10
		}
		modifier = {
			factor = 0.75
			intrigue = 11
		}
		modifier = {
			factor = 0.75
			intrigue = 12
		}
		modifier = {
			factor = 0.75
			intrigue = 13
		}
		modifier = {
			factor = 2
			has_character_flag = job_action_sabotage
			NOT = {
				had_character_flag = {
					flag = job_action_sabotage
					days = 1825
				}
			}
		}
	}

	option = {
		name = EXCELLENT
		hidden_tooltip = { change_variable = { which = "services_rendered" value = 1 } }
		liege = {
			letter_event = { id = MNM.70021 }
			opinion = {
				modifier = opinion_service_rendered
				who = ROOT
				years = 3
			}
		}
		location = {
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				custom_tooltip = {
					text = decrease_prosperity_custom_tooltip
					hidden_tooltip = {
						change_variable = { which = prosperity_value value = -6 }
					}
				}
			}
			random_list = {
				100 = {
					modifier = {
						factor = 0
						has_province_modifier = sabotaged_buildings
					}
					add_province_modifier = {
						name = sabotaged_buildings
						duration = 720
					}
				}
				100 = {
					modifier = {
						factor = 0
						has_province_modifier = sabotaged_defences
					}
					add_province_modifier = {
						name = sabotaged_defences
						duration = 720
					}
				}
				100 = {
					modifier = {
						factor = 0
						has_province_modifier = sabotaged_unrest
					}
					add_province_modifier = {
						name = sabotaged_unrest
						duration = 720
					}
				}
			}
		}
	}
}

letter_event = {
	id = MNM.70021
	desc = MNM.70021.d
	picture = GFX_evt_council
	border = GFX_event_letter_frame_intrigue

	is_triggered_only = yes

	option = {
		name = MNM.70021.o
	}
}

#Court Chaplain
#Hunt Heretics

# Suspectometer
character_event = { # Yearly decrease
	id = MNM.70030
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		OR = {
			society_is_criminal = yes
			is_devil_worshiper_trigger = yes
			has_dark_magic_religion_trigger = yes
		}
	}

	immediate = {
		decrease_visibility_effect = yes
	}
}

# Court Chaplain
# Hunt Apostates

character_event = { # Hunt Apostates meta event
	id = MNM.70100
	title = MNM.70031.t
	hide_window = yes

	min_age = 16
	only_capable = yes
	prisoner = no
	has_job_title = yes

	trigger = {
		has_job_action = action_hunt_heretics
		NOT = { has_game_rule = { name = devil_worshipers value = none } } #the only heretical organisations in game
		NOT = { has_character_modifier = in_seclusion }
	}

	immediate = {
		# Mark targets
		liege = {
			save_event_target_as = my_liege
			# Extremely suspect people
			random_realm_character = {
				limit = {
					prisoner = no
					NOT = { character = ROOT } # Don't catch yourself
					NOT = { character = event_target:my_liege } # Don't catch your liege
					NOT = { same_society_as = ROOT } # Nor your brethren
					NOT = { same_society_as = event_target:my_liege } # Nor liege's brethren
					NAND = { # If you share the same secret religion, dont catch them
						has_my_liege_secret_religion_truly_trigger = yes
						is_devil_worshiper_trigger = no
					}
					NAND = { # If they share secret religion with the liege, dont catch them
						has_prevs_secret_religion_truly_trigger = yes
						is_devil_worshiper_trigger = no
					}
					NOT = {
						reverse_has_opinion_modifier = {
							modifier = opinion_accused_apostate
							who = event_target:my_liege
						}
					}
					is_in_society = yes
					society_is_criminal = yes
					has_character_modifier = highly_suspect
					NOT_mythical_creature_trigger = yes
					NOT = { is_inaccessible_trigger = yes }
				}
				save_event_target_as = highly_suspected_society_member
				#set_character_flag = apostate_extremely_suspect
			}

			# Moderatley suspect people
			random_realm_character = {
				limit = {
					prisoner = no
					NOT = { character = ROOT } # Don't catch yourself
					NOT = { character = event_target:my_liege } # Don't catch your liege
					NOT = { same_society_as = ROOT } # Nor your brethren
					NOT = { same_society_as = event_target:my_liege } # Nor liege's brethren
					NAND = { # If you share the same secret religion, dont catch them
						has_my_liege_secret_religion_truly_trigger = yes
						is_devil_worshiper_trigger = no
					}
					NAND = { # If they share secret religion with the liege, dont catch them
						has_prevs_secret_religion_truly_trigger = yes
						is_devil_worshiper_trigger = no
					}
					NOT = {
						reverse_has_opinion_modifier = {
							modifier = opinion_accused_apostate
							who = event_target:my_liege
						}
					}
					is_in_society = yes
					society_is_criminal = yes
					has_character_modifier = under_suspicion
					NOT_mythical_creature_trigger = yes
					NOT = { is_inaccessible_trigger = yes }
				}
				save_event_target_as = suspected_society_member
				#set_character_flag = apostate_moderate_suspect
			}

			# # Characters with a secret religion
			# random_realm_character = {
				# limit = {
					# prisoner = no
					# NOT = { character = ROOT } # Don't catch yourself
					# NOT = { character = event_target:my_liege } # Don't catch your liege
					# OR = { # Nor your brethren
						# NOT = { same_society_as = ROOT }
						# is_in_society = no
					# }
					# OR = { # Nor liege's brethren
						# NOT = { same_society_as = event_target:my_liege }
						# is_in_society = no
					# }
					# NOT = { has_roots_secret_religion_truly_trigger = yes } # If you share the same secret religion, dont catch them
					# NOT = { has_my_liege_secret_religion_truly_trigger = yes } # If they share secret religion with the liege, dont catch them
					# NOT = {
						# reverse_has_opinion_modifier = {
							# modifier = opinion_accused_apostate
							# who = event_target:my_liege
						# }
					# }
					# religion = event_target:my_liege
					# age = 16
					# has_secret_religion_trait_trigger = yes
					# NOT_mythical_creature_trigger = yes
					# NOT = { is_inaccessible_trigger = yes }
				# }
				# save_event_target_as = suspected_apostate
				## set_character_flag = apostate_secret_religion
			# }

			# Devil worshipers without any suspicion
			random_realm_character = {
				limit = {
					prisoner = no
					NOT = { character = ROOT } # Don't catch yourself
					NOT = { character = event_target:my_liege } # Don't catch your liege
					NOT = { same_society_as = ROOT } # Nor your brethren
					NOT = { same_society_as = event_target:my_liege } # Nor liege's brethren
					NOT = { has_roots_secret_religion_truly_trigger = yes } # If you share the same secret religion, dont catch them
					NOT = { has_prevs_secret_religion_truly_trigger = yes } # If they share secret religion with the liege, dont catch them
					NOT = {
						reverse_has_opinion_modifier = {
							modifier = opinion_accused_apostate
							who = event_target:my_liege
						}
					}
					age = 16
					is_devil_worshiper_trigger = yes
					ai = yes
					NOR = {
						has_character_modifier = highly_suspect
						has_character_modifier = under_suspicion
					}
					ROOT = {
						OR = {
							learning = 16
							AND = {
								learning = 12
								is_in_society = monastic_order_dominican
							}
						}
					}
					NOT_mythical_creature_trigger = yes
					NOT = { is_inaccessible_trigger = yes }
				}
				save_event_target_as = no_suspicion
				#set_character_flag = apostate_no_suspicion
			}

			# Innocent person!
			random_realm_character = {
				limit = {
					prisoner = no
					NOT = { character = ROOT } # Don't catch yourself
					NOT = { character = event_target:my_liege } # Don't catch your liege
					OR = { # Nor your brethren
						NOT = { same_society_as = ROOT }
						is_in_society = no
					}
					OR = { # Nor liege's brethren
						NOT = { same_society_as = event_target:my_liege }
						is_in_society = no
					}
					NOT = { has_roots_secret_religion_truly_trigger = yes } # If you share the same secret religion, dont catch them
					NOT = { has_prevs_secret_religion_truly_trigger = yes } # If they share secret religion with the liege, dont catch them
					NOT = {
						reverse_has_opinion_modifier = {
							modifier = opinion_accused_apostate
							who = event_target:my_liege
						}
					}
					NOT = {
						higher_tier_than = BARON
					}
					age = 16
					NOR = {
						is_devil_worshiper_trigger = yes
						has_character_modifier = highly_suspect
						has_character_modifier = under_suspicion
						has_secret_religion_trait_trigger = yes
					}
					NOT_mythical_creature_trigger = yes
					NOT = { is_inaccessible_trigger = yes }
				}
				save_event_target_as = innocent_victim
				#set_character_flag = apostate_innocent
			}
		}

		if = { # If you're incompetent its more usual to accuse someone innocent
			limit = {
				OR = {
					learning < 6
					is_dumb_trigger = yes
				}
				event_target:innocent_victim = {
					is_alive = yes
				}
			}
			random_list = {
				10 = {
					modifier = {
						factor = 1.25
						learning < 2
					}
					modifier = {
						factor = 1.25
						learning < 4
					}
					modifier = {
						factor = 1.25
						learning < 6
					}
					modifier = {
						factor = 1.25
						learning < 8
					}
					event_target:innocent_victim = {
						save_event_target_as = accused_apostate
					}
					character_event = { id = MNM.70110 }
					break = yes
				}
				90 = {

				}
			}
		}

		if = { # If there is someone who is highly suspicious, always succeed
			limit = {
				event_target:highly_suspected_society_member = {
					is_alive = yes
				}
			}
			event_target:highly_suspected_society_member = {
				save_event_target_as = accused_apostate
			}
			character_event = { id = MNM.70110 }
			break = yes
		}

		if = { # If there is someone semi-suspicious, succeed a bit less often
			limit = {
				event_target:suspected_society_member = {
					is_alive = yes
				}
			}
			random_list = {
				30 = {
					modifier = {
						factor = 0
						event_target:suspected_society_member = {
							ai = no
							NOT = { check_variable = { which = visibility_value value = 19 } }
						}
					}
					modifier = {
						factor = 0.25
						event_target:suspected_society_member = {
							ai = no
						}
					}
					modifier = {
						factor = 1.25
						learning = 10
					}
					modifier = {
						factor = 1.25
						learning = 12
					}
					modifier = {
						factor = 1.25
						learning = 14
					}
					modifier = {
						factor = 1.25
						learning = 16
					}
					modifier = {
						factor = 1.25
						learning = 18
					}
					modifier = {
						factor = 1.25
						learning = 20
					}
					modifier = {
						factor = 1.25
						learning = 22
					}
					modifier = {
						factor = 1.25
						society_member_of = monastic_order_dominican
					}
					event_target:suspected_society_member = {
						save_event_target_as = accused_apostate
					}
					character_event = { id = MNM.70110 }
					break = yes
				}
				70 = {

				}
			}
		}

		if = { # If there is someone with a secret religion, only succeed if you're really good
			limit = {
				event_target:suspected_apostate = {
					is_alive = yes
				}
			}
			random_list = {
				25 = {
					modifier = {
						factor = 0
						event_target:suspected_apostate = {
							ai = no
						}
					}
					modifier = {
						factor = 1.25
						learning = 10
					}
					modifier = {
						factor = 1.25
						learning = 12
					}
					modifier = {
						factor = 1.25
						learning = 14
					}
					modifier = {
						factor = 1.25
						learning = 16
					}
					modifier = {
						factor = 1.25
						learning = 18
					}
					modifier = {
						factor = 1.25
						learning = 20
					}
					modifier = {
						factor = 1.25
						learning = 22
					}
					modifier = {
						factor = 1.25
						society_member_of = monastic_order_dominican
					}
					event_target:suspected_apostate = {
						save_event_target_as = accused_apostate
					}
					character_event = { id = MNM.70110 }
					break = yes
				}
				75 = {

				}
			}
		}

		if = { # If there is a devil worshiper without any level of suspicion, only succeed if you're amazingly good
			limit = {
				event_target:no_suspicion = {
					is_alive = yes
				}
			}
			random_list = {
				25 = {
					modifier = {
						factor = 1.25
						learning = 18
					}
					modifier = {
						factor = 1.25
						learning = 20
					}
					modifier = {
						factor = 1.25
						learning = 22
					}
					modifier = {
						factor = 1.25
						society_member_of = monastic_order_dominican
					}
					event_target:no_suspicion = {
						save_event_target_as = accused_apostate
					}
					character_event = { id = MNM.70110 }
					break = yes
				}
				75 = {

				}
			}
		}

		if = { # Accidently accuse someone innocent!
			limit = {
				event_target:innocent_victim = {
					is_alive = yes
				}
			}
			random_list = {
				3 = {
					modifier = {
						factor = 1.25
						learning < 2
					}
					modifier = {
						factor = 1.25
						learning < 4
					}
					modifier = {
						factor = 1.25
						learning < 6
					}
					modifier = {
						factor = 1.25
						learning < 8
					}
					modifier = {
						factor = 1.25
						is_dumb_trigger = yes
					}
					event_target:innocent_victim = {
						save_event_target_as = accused_apostate
					}
					character_event = { id = MNM.70110 }
					break = yes
				}
				97 = {

				}
			}
		}
	}

	mean_time_to_happen = {
		months = 100

		modifier = {
			factor = 1.25
			learning < 2
		}
		modifier = {
			factor = 1.25
			learning < 4
		}
		modifier = {
			factor = 1.25
			learning < 6
		}
		modifier = {
			factor = 1.25
			learning < 8
		}
		modifier = {
			factor = 0.75
			learning = 10
		}
		modifier = {
			factor = 0.75
			learning = 12
		}
		modifier = {
			factor = 0.75
			learning = 14
		}
		modifier = {
			factor = 0.75
			learning = 16
		}
		modifier = {
			factor = 0.75
			learning = 18
		}
		modifier = {
			factor = 0.75
			learning = 20
		}
		modifier = {
			factor = 0.75
			learning = 22
		}
		modifier = {
			factor = 2
			NOT = { religion_authority = 0.1 }
		}
		modifier = {
			factor = 1.5
			NOT = { religion_authority = 0.2 }
		}
		modifier = {
			factor = 1.25
			NOT = { religion_authority = 0.3 }
		}
		modifier = {
			factor = 1.25
			NOT = { religion_authority = 0.4 }
		}
		modifier = {
			factor = 1.25
			NOT = { religion_authority = 0.5 }
		}
		modifier = {
			factor = 0.9
			religion_authority = 0.6
		}
		modifier = {
			factor = 0.9
			religion_authority = 0.7
		}
		modifier = {
			factor = 0.9
			religion_authority = 0.8
		}
		modifier = {
			factor = 0.9
			religion_authority = 0.9
		}
	}
}

character_event = { # Outcome event
	id = MNM.70110
	title = MNM.70031.t
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:innocent_victim }
		}
		text = MNM.70110.d.innocent_victim
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:highly_suspected_society_member }
		}
		text = MNM.70110.d.highly_suspected_society_member
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:suspected_society_member }
		}
		text = MNM.70110.d.suspected_society_member
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:suspected_apostate }
		}
		text = MNM.70110.d.suspected_apostate
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:no_suspicion }
		}
		text = MNM.70110.d.no_suspicion
	}

	is_triggered_only = yes

	min_age = 16
	only_capable = yes
	prisoner = no

	trigger = {

	}

	immediate = {
		event_target:my_liege = {
			random_realm_character = {
				limit = {
					age = 16
					ai = yes
					is_rival = ROOT
					NOT = {
						character = event_target:my_liege
					}
					NOT = {
						character = event_target:accused_apostate
					}
				}
				save_event_target_as = rival_target
			}
		}
		hidden_tooltip = { change_variable = { which = "services_rendered" value = 1 } }
	}

	option = {
		name = MNM.70110.a

		ai_chance = {
			factor = 90

			modifier = {
				factor = 2
				trait = zealous
			}
		}

		event_target:accused_apostate = {
			opinion = {
				modifier = opinion_hate
				who = ROOT
				years = 100
			}
		}

		custom_tooltip = {
			text = apostate_found_tooltip
		}

		hidden_tooltip = {
			if = {
				limit = {
					has_nickname = no
					NOT = {
						event_target:accused_apostate = { character = event_target:innocent_victim }
					}
				}
				random_list = {
					5000 = {
						# No Nickname
					}
					50 = {
						give_nickname = nick_the_cleansing_flame
					}
					50 = {
						give_nickname = nick_the_witch_hunter
					}
					50 = {
						give_nickname = nick_the_inquisitor
					}
					50 = {
						give_nickname = nick_the_purifier
					}
				}
			}
		}

		liege = {
			character_event = { id = MNM.70200 }
			opinion = {
				modifier = opinion_service_rendered
				who = ROOT
				years = 3
			}
		}
	}

	option = {
		name = MNM.70110.b
		tooltip_info = deceitful

		trigger = {
			trait = deceitful
			event_target:rival_target = {
				is_alive = yes
			}
		}

		ai_chance = {
			factor = 1000

			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 2
				trait = possessed
			}
			modifier = {
				factor = 2
				trait = cruel
			}
			modifier = {
				factor = 2
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
		}

		custom_tooltip = {
			text = accuse_rival_tooltip
		}

		event_target:rival_target = {
			save_event_target_as = accused_apostate
			set_character_flag = apostate_rival_accused
		}
		liege = {
			character_event = { id = MNM.70200 }
			opinion = {
				modifier = opinion_service_rendered
				who = ROOT
				years = 3
			}
		}
	}
}

character_event = { # What does the liege wish to do with the apostate?
	id = MNM.70200
	title = MNM.70031.t
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_religion

	trigger = {
		event_target:accused_apostate = {
			is_alive = yes
		}
	}

	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:innocent_victim }
		}
		text = MNM.70200.d.innocent_victim
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:highly_suspected_society_member }
		}
		text = MNM.70200.d.highly_suspected_society_member
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:suspected_society_member }
		}
		text = MNM.70200.d.suspected_society_member
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:suspected_apostate }
		}
		text = MNM.70200.d.suspected_apostate
	}
	desc = {
		trigger = {
			event_target:accused_apostate = { character = event_target:no_suspicion }
		}
		text = MNM.70200.d.no_suspicion
	}

	is_triggered_only = yes

	option = { # Execute them!
		name = MNM.70200.a

		ai_chance = {
			factor = 50

			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 2
				trait = possessed
			}
			modifier = {
				factor = 2
				trait = cruel
			}
			modifier = {
				factor = 2
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 100
				trait = zealous
			}
		}

		piety = 25

		tooltip = {
			event_target:accused_apostate = {
				death = {
					death_reason = death_execution_burning
					killer = ROOT
				}
			}
		}
		event_target:accused_apostate = { save_event_target_as = kinslayer_target } #check for kinslayer
		add_kinslayer_trait_effect = yes
		hidden_tooltip = {
			event_target:accused_apostate = {
				character_event = { id = MNM.70300 }
			}
			if = {
				limit = {
					has_nickname = no
					NOT = {
						event_target:accused_apostate = { character = event_target:innocent_victim }
					}
				}
				random_list = {
					5000 = {
						# No Nickname
					}
					5 = {
						give_nickname = nick_the_cleansing_flame
					}
					5 = {
						give_nickname = nick_the_witch_hunter
					}
					5 = {
						give_nickname = nick_the_inquisitor
					}
					5 = {
						give_nickname = nick_the_purifier
					}
				}
			}
		}
	}

	option = { # Imprison them
		name = MNM.70200.b

		ai_chance = {
			factor = 40

			modifier = {
				factor = 2
				trait = kind
			}
			modifier = {
				factor = 3
				event_target:accused_apostate = {
					ai = no
				}
			}
			modifier = {
				factor = 5
				event_target:accused_apostate = {
					dynasty = ROOT
				}
			}
		}
		tooltip = {
			event_target:accused_apostate = {
				imprison = ROOT
				if = {
					limit = {
						is_devil_worshiper_trigger = yes
						OR = {
							has_character_modifier = under_suspicion
							has_character_modifier = highly_suspect
						}
					}
					add_character_modifier = {
						name = known_satanist
						duration = -1
					}
				}
				if = {
					limit = {
						OR = {
							is_devil_worshiper_trigger = no
							AND = {
								is_devil_worshiper_trigger = yes
								NOR = {
									has_character_modifier = under_suspicion
									has_character_modifier = highly_suspect
								}
							}
						}
					}
					add_character_modifier = {
						name = accused_apostate
						duration = -1
					}
				}
				if = {
					limit = {
						religion = ROOT
						controls_religion = no
						religion = the_seven
					}
					excommunicate_effect = yes
				}
			}
		}
		hidden_tooltip = {
			event_target:accused_apostate = {
				character_event = { id = MNM.70310 }
			}
		}
	}

	option = { # Brand them
		name = MNM.70200.c

		ai_chance = {
			factor = 100

			modifier = {
				factor = 0
				NOT = {
					trait = trusting
				}
			}
		}

		tooltip = {
			event_target:accused_apostate = {
				if = {
					limit = {
						is_devil_worshiper_trigger = yes
						OR = {
							has_character_modifier = under_suspicion
							has_character_modifier = highly_suspect
						}
					}
					add_character_modifier = {
						name = known_satanist
						duration = -1
					}
				}
				if = {
					limit = {
						OR = {
							is_devil_worshiper_trigger = no
							AND = {
								is_devil_worshiper_trigger = yes
								NOR = {
									has_character_modifier = under_suspicion
									has_character_modifier = highly_suspect
								}
							}
						}
					}
					add_character_modifier = {
						name = accused_apostate
						duration = -1
					}
				}
				if = {
					limit = {
						religion = ROOT
						controls_religion = no
						religion = the_seven
					}
					excommunicate_effect = yes
				}
			}
		}

		hidden_tooltip = {
			event_target:accused_apostate = {
				character_event = { id = MNM.70320 }
			}
		}
	}

	option = { # Let them go
		name = MNM.70200.d

		ai_chance = {
			factor = 10

			modifier = {
				factor = 0
				NOT = {
					trait = trusting
				}
			}
		}

		piety = -40

		hidden_tooltip = {
			event_target:accused_apostate = {
				character_event = { id = MNM.70330 }
			}
		}
		reverse_opinion = {
			modifier = opinion_outraged
			who = FROM
			years = 10
		}
	}
}

character_event = { # The Apostate reacts to Execution
	id = MNM.70300
	desc = MNM.70300.d
	picture = GFX_evt_witch_burning
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = {
			text = MNM.70300.a
			trigger = { is_devil_worshiper_trigger = yes }
		}
		name = {
			text = MNM.70300.b
			trigger = { is_devil_worshiper_trigger = no }
		}
		if = {
			limit = {
				religion = FROM
				controls_religion = no
				religion = the_seven
			}
			excommunicate_effect = yes
		}
		death = {
			death_reason = death_execution_burning
			killer = FROM
		}
		hidden_tooltip = { # Inform players that fellow society member has been executed
			any_player = {
				limit = {
					OR = {
						same_realm = ROOT
						is_close_relative = ROOT
						is_friend = ROOT
					}
					same_society_as = ROOT
					NOT = {
						character = ROOT
					}
				}
				character_event = { id = MNM.70400 }
			}
		}
	}
}

character_event = { # The Apostate reacts to Imprisonment
	id = MNM.70310
	desc = MNM.70310.d
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = MNM.70310.a
		imprison = FROM
		reverse_opinion = {
			modifier = opinion_accused_apostate
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_accused_apostate
			who = FROMFROM
			years = 10
		}
		if = {
			limit = {
				is_devil_worshiper_trigger = yes
				OR = {
					has_character_modifier = under_suspicion
					has_character_modifier = highly_suspect
				}
			}
			add_character_modifier = {
				name = known_satanist
				duration = -1
			}
		}
		if = {
			limit = {
				OR = {
					is_devil_worshiper_trigger = no
					AND = {
						is_devil_worshiper_trigger = yes
						NOR = {
							has_character_modifier = under_suspicion
							has_character_modifier = highly_suspect
						}
					}
				}
			}
			add_character_modifier = {
				name = accused_apostate
				duration = -1
			}
		}
		if = {
			limit = {
				religion = FROM
				controls_religion = no
				religion = the_seven
			}
			excommunicate_effect = yes
		}
		hidden_tooltip = { # Inform players that fellow society member has been imprisoned
			any_player = {
				limit = {
					primary_title = { always = yes }
					OR = {
						same_realm = ROOT
						is_close_relative = ROOT
						is_friend = ROOT
					}
					same_society_as = ROOT
					NOT = {
						character = ROOT
					}
				}
				character_event = { id = MNM.70400 }
			}
		}
	}
}

character_event = { # The Apostate reacts to Branding
	id = MNM.70320
	desc = MNM.70320.d
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = MNM.70320.a
		reverse_opinion = {
			modifier = opinion_accused_apostate
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_accused_apostate
			who = FROMFROM
			years = 10
		}
		if = {
			limit = {
				is_devil_worshiper_trigger = yes
				OR = {
					has_character_modifier = under_suspicion
					has_character_modifier = highly_suspect
				}
			}
			add_character_modifier = {
				name = known_satanist
				duration = -1
			}
		}
		if = {
			limit = {
				OR = {
					is_devil_worshiper_trigger = no
					AND = {
						is_devil_worshiper_trigger = yes
						NOR = {
							has_character_modifier = under_suspicion
							has_character_modifier = highly_suspect
						}
					}
				}
			}
			add_character_modifier = {
				name = accused_apostate
				duration = -1
			}
		}
		if = {
			limit = {
				religion = FROM
				controls_religion = no
				religion = the_seven
			}
			excommunicate_effect = yes
		}
		hidden_tooltip = { # Inform players that fellow society member has been branded
			any_player = {
				limit = {
					OR = {
						same_realm = ROOT
						is_close_relative = ROOT
						is_friend = ROOT
					}
					same_society_as = ROOT
					NOT = {
						character = ROOT
					}
				}
				character_event = { id = MNM.70400 }
			}
		}
	}
}

character_event = { # The Apostate reacts to Mercy
	id = MNM.70330
	desc = MNM.70330.d
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = MNM.70320.a
		reverse_opinion = {
			modifier = opinion_accused_apostate
			who = FROMFROM
			years = 10
		}
	}
}

character_event = { # Player society members are informed that a fellow member has been caught
	id = MNM.70400
	picture = GFX_evt_catching_heretic
	border = GFX_event_normal_frame_religion

	desc = {
		trigger = {
			FROM = {
				is_alive = no
			}
		}
		text = MNM.70400.d.executed
		picture = GFX_evt_witch_burning
	}
	desc = {
		trigger = {
			FROM = {
				is_alive = yes
				prisoner = yes
			}
		}
		text = MNM.70400.d.imprisoned
	}
	desc = {
		trigger = {
			FROM = {
				is_alive = yes
				prisoner = no
			}
		}
		text = MNM.70400.d.caught
	}

	is_triggered_only = yes

	option = {
		name = MNM.70400.a
		tooltip_info = paranoid

		trigger = {
			trait = paranoid
		}

		event_target:my_liege = {
			set_character_flag = portrait_flag
			clr_character_flag = portrait_flag
		}

		event_target:my_liege = {
			job_spiritual = {
				set_character_flag = portrait_flag
				clr_character_flag = portrait_flag
			}
		}

		decrease_visibility_effect = yes
	}

	option = {
		name = CURSES

		event_target:my_liege = {
			set_character_flag = portrait_flag
			clr_character_flag = portrait_flag
		}

		event_target:my_liege = {
			job_spiritual = {
				set_character_flag = portrait_flag
				clr_character_flag = portrait_flag
			}
		}
	}
}
